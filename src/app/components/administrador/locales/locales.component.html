<div class="container">
ย ย <aside class="left">
ย ย ย ย <div class="logo">
ย ย ย ย ย ย <img src="assets/icon/logo.jpg" alt="Logo" />
ย ย ย ย </div>
ย ย ย ย <nav>
ย ย ย ย ย ย <ul>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('inicio')">๐ Inicio</a></li>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('locales')" class="active">๐ Locales</a></li>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('socios')">๐งโ๐คโ๐ง Socios</a></li>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('oferta')">๐ท Ofertas</a></li>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('plano_contenedores')">๐ Contenedores</a></li>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('producto')">๐ฆ Productos</a></li>

ย ย ย ย ย ย </ul>
ย ย ย ย </nav>
ย ย ย ย <nav>
ย ย ย ย ย ย <ul>
ย ย ย ย ย ย ย ย <li><a (click)="irAPagina('gestion-usuarios')">๐ค Usuarios</a></li>

ย ย ย ย ย ย </ul>
ย ย ย ย </nav>
ย ย </aside>

ย ย <main>
ย ย ย ย <div class="locales-table-container">
ย ย ย ย ย ย <h2>Listado de Locales</h2>
ย ย ย ย ย ย <div class="filter-section mb-4 p-3 border rounded">
ย ย ย ย ย ย ย ย <h4>Filtros de Bรบsqueda</h4>
ย ย ย ย ย ย ย ย <div class="row">
ย ย ย ย ย ย ย ย ย ย <div class="col-md-6 mb-3">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="filterBloque" class="form-label">Filtrar por Bloque:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="filterBloque" class="form-select" [(ngModel)]="filterBloque"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย (change)="applyFilters()" name="filterBloque">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option [ngValue]="null">Todos los Bloques</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option *ngFor="let bloque of bloquesUnicos" [ngValue]="bloque">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย {{ bloque }}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="col-md-6 mb-3">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="filterNombreLocal" class="form-label">Buscar por Nombre de Local:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input type="text" id="filterNombreLocal" class="form-control" [(ngModel)]="filterNombreLocal"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย (input)="applyFilters()" name="filterNombreLocal" placeholder="Escribe el nombre del local">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <button class="btn-crear" (click)="abrirFormularioCrear()">+ Crear Nuevo Local</button>

ย ย ย ย ย ย <div *ngIf="locales.length > 0; else noLocales">
ย ย ย ย ย ย ย ย <table>
ย ย ย ย ย ย ย ย ย ย <thead>
ย ย ย ย ย ย ย ย ย ย ย ย <tr>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Nombre del Negocio</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Nombre del Dueรฑo</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Cรณdigo Local</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>RUC</th> <!-- Nuevo encabezado de columna -->
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Correo</th> <!-- Nuevo encabezado de columna -->
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Facebook</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Instagram</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>TikTok</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Telรฉfono</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Nยฐ Contenedor</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Descripciรณn</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Imรกgenes</th>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <th>Acciones</th>
ย ย ย ย ย ย ย ย ย ย ย ย </tr>
ย ย ย ย ย ย ย ย ย ย </thead>
ย ย ย ย ย ย ย ย ย ย <tbody>
ย ย ย ย ย ย ย ย ย ย ย ย <tr *ngFor="let local of locales">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.nombre_del_negocio }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.nombre_del_dueno }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.codigo_local }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.ruc || 'N/A' }}</td> <!-- Nuevo campo en la tabla -->
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.correo || 'N/A' }}</td> <!-- Nuevo campo en la tabla -->
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.facebook || 'N/A' }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.instagram || 'N/A' }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.tiktok || 'N/A' }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.telefono || 'N/A' }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.id_contenedor }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>{{ local.descripcion || 'N/A' }}</td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="local-images-gallery">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <img *ngFor="let imageUrl of local.imagen_urls" [src]="getImageUrl(imageUrl)" alt="Imagen del local"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย class="local-image-thumbnail">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <span *ngIf="!local.imagen_urls || local.imagen_urls.length === 0">N/A</span>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </td>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <td class="acciones">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-accion btn-editar"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย (click)="abrirFormularioEditar(local)">Editar</button>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn-accion btn-eliminar"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย (click)="eliminarLocal(local.id_local, local.nombre_del_negocio)">Eliminar</button>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </td>
ย ย ย ย ย ย ย ย ย ย ย ย </tr>
ย ย ย ย ย ย ย ย ย ย </tbody>
ย ย ย ย ย ย ย ย </table>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <ng-template #noLocales>
ย ย ย ย ย ย ย ย <p>No hay locales para mostrar.</p>
ย ย ย ย ย ย </ng-template>
ย ย ย ย </div>

ย ย ย ย <div class="modal-backdrop" *ngIf="mostrarFormulario">
ย ย ย ย ย ย <div class="modal-content">
ย ย ย ย ย ย ย ย <h3>{{ localSeleccionado ? 'Editar Local' : 'Crear Nuevo Local' }}</h3>
ย ย ย ย ย ย ย ย <form (ngSubmit)="guardarLocal()">
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="nombreNegocio">Nombre del Negocio:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="nombreNegocio" type="text" [(ngModel)]="nuevoLocal.nombre_del_negocio"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย name="nombre_del_negocio" required>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="nombreDueno">Nombre del Dueรฑo:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="nombreDueno" type="text" [(ngModel)]="nuevoLocal.nombre_del_dueno"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย name="nombre_del_dueno" required>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="codigoLocal">Cรณdigo Local:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="codigoLocal" type="text" [(ngModel)]="nuevoLocal.codigo_local" name="codigo_local"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย required>
ย ย ย ย ย ย ย ย ย ย </div>
                    <div class="form-group">
                        <label for="ruc">RUC:</label>
                        <input id="ruc" type="text" [(ngModel)]="nuevoLocal.ruc" name="ruc">
                    </div>
                    <div class="form-group">
                        <label for="correo">Correo:</label>
                        <input id="correo" type="email" [(ngModel)]="nuevoLocal.correo" name="correo">
                    </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="facebook">Facebook:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="facebook" type="url" [(ngModel)]="nuevoLocal.facebook" name="facebook">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="instagram">Instagram:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="instagram" type="url" [(ngModel)]="nuevoLocal.instagram" name="instagram">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="tiktok">TikTok:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="tiktok" type="url" [(ngModel)]="nuevoLocal.tiktok" name="tiktok">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="telefono">Telรฉfono:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input id="telefono" type="text" [(ngModel)]="nuevoLocal.telefono" name="telefono">
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="selectBloque">Bloque:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="selectBloque" [(ngModel)]="nuevoLocal.selectedBloque" (change)="onBloqueSelected()"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย name="nuevoLocal_selectedBloque" required>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option [ngValue]="null" disabled>Selecciona un Bloque</option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option *ngFor="let bloque of bloquesUnicos" [ngValue]="bloque">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย {{ bloque }}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>

ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="idContenedor">Nยฐ Contenedor:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <select id="idContenedor" [(ngModel)]="nuevoLocal.id_contenedor" name="id_contenedor" required
ย ย ย ย ย ย ย ย ย ย ย ย ย ย [disabled]="!nuevoLocal.selectedBloque">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option [ngValue]="0" disabled>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย {{ nuevoLocal.selectedBloque ? 'Selecciona un contenedor' : 'Selecciona un bloque
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย primero' }}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </option>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <option *ngFor="let contenedor of contenedoresFiltrados"
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย [ngValue]="contenedor.id_contenedor">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย {{ contenedor.numero_contenedor }}
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </option>
ย ย ย ย ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย ย ย ย ย </div>

ย ย ย ย ย ย ย ย ย ย <!-- NUEVO CAMPO: Descripciรณn -->
ย ย ย ย ย ย ย ย ย ย <div class="form-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="descripcion">Descripciรณn:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <textarea id="descripcion" [(ngModel)]="nuevoLocal.descripcion" name="descripcion"></textarea>
ย ย ย ย ย ย ย ย ย ย </div>

ย ย ย ย ย ย ย ย ย ย <div class="form-group file-upload-group">
ย ย ย ย ย ย ย ย ย ย ย ย <label for="imagenLocal">Imรกgenes del Local:</label>
ย ย ย ย ย ย ย ย ย ย ย ย <input type="file" id="imagenLocal" (change)="onFileSelected($event)" accept="image/*" multiple
ย ย ย ย ย ย ย ย ย ย ย ย ย ย name="imagenLocal">
ย ย ย ย ย ย ย ย ย ย ย ย <div *ngIf="nuevoLocal.imagen_urls && nuevoLocal.imagen_urls.length > 0" class="images-preview-gallery">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="image-preview-item" *ngFor="let imageUrl of nuevoLocal.imagen_urls; let i = index">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <img [src]="getImageUrl(imageUrl)" alt="Previsualizaciรณn de imagen" class="image-preview">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button type="button" class="clear-image-btn" (click)="removeImage(i)">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย &times;
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย ย ย <span *ngIf="!nuevoLocal.imagen_urls || nuevoLocal.imagen_urls.length === 0" class="no-image-text">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย No hay imรกgenes seleccionadas.
ย ย ย ย ย ย ย ย ย ย ย ย </span>
ย ย ย ย ย ย ย ย ย ย </div>

ย ย ย ย ย ย ย ย ย ย <div class="form-actions">
ย ย ย ย ย ย ย ย ย ย ย ย <button type="submit" class="btn-guardar">{{ localSeleccionado ? 'Guardar Cambios' : 'Crear
ย ย ย ย ย ย ย ย ย ย ย ย ย ย Local' }}</button>
ย ย ย ย ย ย ย ย ย ย ย ย <button type="button" class="btn-cancelar" (click)="cerrarFormulario()">Cancelar</button>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย </form>
ย ย ย ย ย ย </div>
ย ย ย ย </div>
ย ย </main>
</div>
